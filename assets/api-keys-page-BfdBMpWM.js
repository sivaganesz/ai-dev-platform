import{e as E,j as e,B as m,i as r,o as S,n as p,l as k,a2 as N,M as D}from"./index-CyvJUZqR.js";import{u as I}from"./useQuery-DOA-4dB4.js";import{T as b,a as v,b as u,c as n,d as w,e as i}from"./table-DPilA-Lh.js";import{C as T}from"./copy-BhE0TJ9y.js";import{T as C}from"./trash-2-GPajQJ1z.js";import{C as c,a as d,b as o,c as x}from"./card-9e5eR-TL.js";import{S as K}from"./shield-alert-D94mR99W.js";import{S as L}from"./shield-x-e52gnovD.js";import{L as R}from"./layers-d--2co6E.js";import{D as P,f as U,a as _,b as z,c as M,d as G,e as F}from"./dialog-CXSb95VD.js";import{I as H}from"./input-8HBaoNJU.js";import{S as h,a as j,b as f,c as g,d as l}from"./select-DMU1Mhcj.js";import{P as W}from"./plus-BmaVqT4C.js";import{R as O}from"./rotate-ccw-DdaKt6N-.js";import{L as V}from"./lock-DjxgDLYE.js";import{R as X,T as Z}from"./CategoricalChart-WJAmy3lP.js";import{A as B,a as q}from"./AreaChart-B_cJzpI-.js";import{C as Y}from"./CartesianGrid-BmRwr4Ov.js";import{X as J,Y as Q}from"./CartesianChart-Kxs-tJ8o.js";import{C as $}from"./clock-BXrF9XKR.js";import{G as ee}from"./globe-CET8i7Ac.js";import{D as se}from"./download-BXaKmJWL.js";import"./index-p66pR0EO.js";import"./chevron-down-DT8imn2m.js";import"./ActivePoints-CruzyNxB.js";import"./getRadiusAndStrokeWidthFromDot-fpoNHmAp.js";import"./graphicalItemSelectors-01I7ku9s.js";const te=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],ae=E("rotate-cw",te),re=[{id:"AK-001",name:"Agents Execution Key",keyId:"key_agt_8829",scope:"AI Agents",owner:"Peter Johnson",createdDate:"2026-01-10",expiryDate:"2026-04-10",status:"ACTIVE",lastUsed:"2026-02-14T10:30:00Z",environment:"Production",permissions:["EXECUTE","READ"]},{id:"AK-002",name:"Workflow Trigger Key",keyId:"key_wf_1102",scope:"Workflows",owner:"System",createdDate:"2026-01-15",expiryDate:"2026-03-15",status:"ACTIVE",lastUsed:"2026-02-14T09:15:00Z",environment:"Staging",permissions:["EXECUTE"]},{id:"AK-003",name:"Sandbox Runner Key",keyId:"key_sbx_4491",scope:"Sandbox",owner:"Alice Smith",createdDate:"2026-02-01",expiryDate:"2026-05-01",status:"ACTIVE",lastUsed:"2026-02-13T17:00:00Z",environment:"Sandbox",permissions:["READ","WRITE","EXECUTE"]},{id:"AK-004",name:"GitHub Sync Key",keyId:"key_git_0023",scope:"Integrations",owner:"DevOps Agent",createdDate:"2025-11-10",expiryDate:"2026-02-10",status:"EXPIRED",lastUsed:"2026-02-10T23:59:00Z",environment:"Production",permissions:["READ","WRITE"]},{id:"AK-005",name:"Demo Build Key",keyId:"key_db_7712",scope:"Demo Builds",owner:"Sarah Lee",createdDate:"2026-02-10",expiryDate:"2026-05-10",status:"ACTIVE",lastUsed:"2026-02-14T11:45:00Z",environment:"Development",permissions:["EXECUTE"]},{id:"AK-006",name:"Legacy Analytics Key",keyId:"key_leg_9901",scope:"Monitoring & Logs",owner:"System",createdDate:"2025-08-10",expiryDate:"2025-11-10",status:"REVOKED",lastUsed:"2025-11-05T14:20:00Z",environment:"Production",permissions:["READ"]}],ne=[{name:"AI Agents",count:5,lastExecution:"2 mins ago",riskLevel:"HIGH"},{name:"Workflows",count:3,lastExecution:"1 hour ago",riskLevel:"MEDIUM"},{name:"Governance Systems",count:2,lastExecution:"Yesterday",riskLevel:"HIGH"},{name:"Sandbox Environments",count:8,lastExecution:"4 hours ago",riskLevel:"LOW"},{name:"Integrations",count:4,lastExecution:"3 days ago",riskLevel:"MEDIUM"}],ie=[{id:"L-001",keyId:"key_agt_8829",module:"AI Agents",action:"Execution",status:"SUCCESS",timestamp:"2026-02-14T10:30:00Z",ipAddress:"192.168.1.45"},{id:"L-002",keyId:"key_wf_1102",module:"Workflows",action:"Trigger",status:"SUCCESS",timestamp:"2026-02-14T09:15:00Z",ipAddress:"10.0.0.12"},{id:"L-003",keyId:"key_db_7712",module:"Demo Builds",action:"Access",status:"FAILED",timestamp:"2026-02-14T11:45:00Z",ipAddress:"45.22.11.9"},{id:"L-004",keyId:"key_agt_8829",module:"AI Agents",action:"Execution",status:"SUCCESS",timestamp:"2026-02-14T10:25:00Z",ipAddress:"192.168.1.45"}],le=[{name:"Feb 08",executions:450},{name:"Feb 09",executions:520},{name:"Feb 10",executions:840},{name:"Feb 11",executions:610},{name:"Feb 12",executions:720},{name:"Feb 13",executions:980},{name:"Feb 14",executions:1240}],ce={total:24,active:18,expired:4,revoked:2};function de(){return I({queryKey:["api-keys-data"],queryFn:async()=>(await new Promise(t=>setTimeout(t,500)),{keys:re,scopes:ne,logs:ie,usageTrend:le,summary:ce})})}function oe({keys:t}){const s=a=>{switch(a){case"ACTIVE":return"default";case"EXPIRED":return"destructive";case"REVOKED":return"secondary";default:return"outline"}},A=a=>{switch(a){case"Production":return"bg-red-500/10 text-red-500 border-red-500/20";case"Staging":return"bg-yellow-500/10 text-yellow-500 border-yellow-500/20";case"Sandbox":return"bg-blue-500/10 text-blue-500 border-blue-500/20";default:return"bg-muted text-muted-foreground"}};return e.jsx("div",{className:"rounded-md border bg-card",children:e.jsxs(b,{children:[e.jsx(v,{children:e.jsxs(u,{children:[e.jsx(n,{children:"Key Name"}),e.jsx(n,{children:"Scope"}),e.jsx(n,{children:"Environment"}),e.jsx(n,{children:"Permissions"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Last Used"}),e.jsx(n,{className:"text-right",children:"Actions"})]})}),e.jsx(w,{children:t.map(a=>e.jsxs(u,{className:"group",children:[e.jsx(i,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm",children:a.name}),e.jsx("span",{className:"text-[10px] font-mono text-muted-foreground uppercase",children:a.keyId})]})}),e.jsx(i,{children:e.jsx(m,{variant:"outline",className:"text-[10px] uppercase font-bold tracking-tighter",children:a.scope})}),e.jsx(i,{children:e.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded border ${A(a.environment)}`,children:a.environment.toUpperCase()})}),e.jsx(i,{children:e.jsx("div",{className:"flex gap-1",children:a.permissions.map(y=>e.jsx("span",{className:"text-[9px] font-bold text-muted-foreground",children:y[0]},y))})}),e.jsx(i,{children:e.jsx(m,{variant:s(a.status),className:"text-[9px] h-4",children:a.status})}),e.jsx(i,{className:"text-[10px] text-muted-foreground",children:new Date(a.lastUsed).toLocaleDateString()}),e.jsx(i,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(r,{size:"icon",variant:"ghost",className:"h-7 w-7",children:e.jsx(T,{className:"h-3.5 w-3.5"})}),e.jsx(r,{size:"icon",variant:"ghost",className:"h-7 w-7",children:e.jsx(ae,{className:"h-3.5 w-3.5"})}),e.jsx(r,{size:"icon",variant:"ghost",className:"h-7 w-7 text-red-500",children:e.jsx(C,{className:"h-3.5 w-3.5"})})]})})]},a.id))})]})})}function xe({summary:t}){return e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-[10px] font-bold uppercase tracking-wider text-muted-foreground",children:"Total API Keys"}),e.jsx(S,{className:"h-4 w-4 text-primary"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.total}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Managed credentials"})]})]}),e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-[10px] font-bold uppercase tracking-wider text-muted-foreground",children:"Active Keys"}),e.jsx(p,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.active}),e.jsx("p",{className:"text-[10px] text-green-500 font-medium",children:"Ready for execution"})]})]}),e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-[10px] font-bold uppercase tracking-wider text-muted-foreground",children:"Expired Keys"}),e.jsx(K,{className:"h-4 w-4 text-yellow-500"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.expired}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Requires rotation"})]})]}),e.jsxs(c,{className:"border-red-500/20",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-[10px] font-bold uppercase tracking-wider text-red-500",children:"Revoked Keys"}),e.jsx(L,{className:"h-4 w-4 text-red-500"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.revoked}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Permanently disabled"})]})]})]})}function me({scopes:t}){return e.jsxs(c,{children:[e.jsx(d,{children:e.jsxs(o,{className:"text-sm font-bold flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4 text-primary"}),"Key Scope Classification"]})}),e.jsx(x,{className:"space-y-4",children:t.map(s=>e.jsxs("div",{className:"p-3 rounded-lg border bg-muted/20 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold",children:s.name}),e.jsxs(m,{variant:s.riskLevel==="HIGH"?"destructive":"outline",className:"text-[9px] h-4",children:[s.riskLevel," RISK"]})]}),e.jsxs("div",{className:"flex justify-between items-center text-[10px] text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"h-3 w-3"}),s.count," Keys"]}),e.jsxs("span",{children:["Used ",s.lastExecution]})]})]},s.name))})]})}function pe(){return e.jsxs(P,{children:[e.jsx(U,{asChild:!0,children:e.jsxs(r,{size:"sm",children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Create New API Key"]})}),e.jsxs(_,{className:"sm:max-w-[500px]",children:[e.jsxs(z,{children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5 text-primary"}),"Generate Access Credential"]}),e.jsx(G,{children:"Specify the scope and capability for the new API key."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-muted-foreground",children:"Key Name"}),e.jsx(H,{placeholder:"e.g. Agents Pipeline Executor"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-muted-foreground",children:"Module Scope"}),e.jsxs(h,{children:[e.jsx(j,{className:"h-8 text-xs",children:e.jsx(f,{placeholder:"Select Scope"})}),e.jsxs(g,{children:[e.jsx(l,{value:"agents",children:"AI Agents"}),e.jsx(l,{value:"workflows",children:"Workflows"}),e.jsx(l,{value:"sandbox",children:"Sandbox"}),e.jsx(l,{value:"integrations",children:"Integrations"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-muted-foreground",children:"Environment"}),e.jsxs(h,{children:[e.jsx(j,{className:"h-8 text-xs",children:e.jsx(f,{placeholder:"Select Env"})}),e.jsxs(g,{children:[e.jsx(l,{value:"dev",children:"Development"}),e.jsx(l,{value:"sbx",children:"Sandbox"}),e.jsx(l,{value:"prd",children:"Production"})]})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-muted-foreground",children:"Permissions"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(r,{variant:"outline",size:"sm",className:"h-7 text-[9px] px-3",children:"READ"}),e.jsx(r,{variant:"outline",size:"sm",className:"h-7 text-[9px] px-3",children:"WRITE"}),e.jsx(r,{variant:"default",size:"sm",className:"h-7 text-[9px] px-3",children:"EXECUTE"}),e.jsx(r,{variant:"outline",size:"sm",className:"h-7 text-[9px] px-3",children:"ADMIN"})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-muted-foreground",children:"Expiry Policy"}),e.jsxs(h,{defaultValue:"30",children:[e.jsx(j,{className:"h-8 text-xs",children:e.jsx(f,{placeholder:"Select Expiry"})}),e.jsxs(g,{children:[e.jsx(l,{value:"30",children:"30 Days (Recommended)"}),e.jsx(l,{value:"60",children:"60 Days"}),e.jsx(l,{value:"90",children:"90 Days"}),e.jsx(l,{value:"0",children:"Never (Restricted)"})]})]})]})]}),e.jsx(F,{children:e.jsx(r,{type:"submit",className:"w-full",children:"Generate Secure Token"})})]})]})}function ue(){const t=[{name:"Auto Key Rotation",status:"Enabled",icon:O},{name:"Expiry Alerts (7 days)",status:"Enabled",icon:D},{name:"IP Locking Policy",status:"Optional",icon:V},{name:"MFA for Execute",status:"Required",icon:p}];return e.jsxs(c,{children:[e.jsx(d,{children:e.jsxs(o,{className:"text-sm font-bold flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-primary"}),"Security & Rotation Policies"]})}),e.jsxs(x,{className:"space-y-3",children:[t.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded border bg-muted/10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s.icon,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium",children:s.name})]}),e.jsx(m,{variant:s.status==="Required"||s.status==="Enabled"?"default":"outline",className:"text-[9px] h-4 uppercase",children:s.status})]},s.name)),e.jsx(r,{variant:"outline",size:"sm",className:"w-full text-[10px] h-8 mt-2 font-bold uppercase tracking-widest",children:"Apply Org-Wide Policy"})]})]})}function he({data:t}){return e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(o,{className:"text-sm font-bold uppercase tracking-widest text-muted-foreground",children:"7-Day Execution Analytics"})}),e.jsx(x,{children:e.jsx("div",{className:"h-[200px] w-full",children:e.jsx(X,{width:"100%",height:"100%",children:e.jsxs(B,{data:t,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorUsage",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),e.jsx(Y,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),e.jsx(J,{dataKey:"name",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(Q,{fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(Z,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:"10px"}}),e.jsx(q,{type:"monotone",dataKey:"executions",stroke:"#3b82f6",strokeWidth:2,fillOpacity:1,fill:"url(#colorUsage)"})]})})})})]})}function je({logs:t}){return e.jsxs("div",{className:"rounded-md border bg-card",children:[e.jsx("div",{className:"p-3 border-b bg-muted/30",children:e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-widest text-muted-foreground flex items-center gap-2",children:[e.jsx($,{className:"h-3.5 w-3.5"}),"Real-time Authentication Logs"]})}),e.jsxs(b,{children:[e.jsx(v,{children:e.jsxs(u,{className:"bg-muted/50",children:[e.jsx(n,{className:"text-[10px] font-bold",children:"Key ID"}),e.jsx(n,{className:"text-[10px] font-bold",children:"Module"}),e.jsx(n,{className:"text-[10px] font-bold",children:"Action"}),e.jsx(n,{className:"text-[10px] font-bold text-center",children:"Status"}),e.jsx(n,{className:"text-[10px] font-bold",children:"Timestamp"}),e.jsx(n,{className:"text-[10px] font-bold text-right",children:"Source IP"})]})}),e.jsx(w,{className:"text-[11px] font-mono",children:t.map(s=>e.jsxs(u,{children:[e.jsx(i,{className:"uppercase text-muted-foreground",children:s.keyId}),e.jsx(i,{className:"font-bold",children:s.module}),e.jsx(i,{children:s.action}),e.jsx(i,{className:"text-center",children:e.jsx(m,{variant:s.status==="SUCCESS"?"default":"destructive",className:"text-[8px] h-3.5 px-1 uppercase",children:s.status})}),e.jsx(i,{className:"whitespace-nowrap text-muted-foreground",children:new Date(s.timestamp).toLocaleTimeString()}),e.jsxs(i,{className:"text-right flex items-center justify-end gap-1 text-muted-foreground",children:[e.jsx(ee,{className:"h-2.5 w-2.5"}),s.ipAddress]})]},s.id))})]})]})}function Oe(){const{data:t,isLoading:s}=de();return s?e.jsx("div",{className:"flex items-center justify-center h-full text-sm font-mono",children:"Authenticating credentials..."}):e.jsxs("div",{className:"flex-1 space-y-6 p-4 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"API Key Management"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Export Registry"]}),e.jsx(pe,{})]})]}),e.jsx(xe,{summary:t?.summary}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-9 space-y-6",children:[e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between",children:[e.jsx(o,{className:"text-lg font-bold",children:"Credential Registry"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"ghost",size:"sm",className:"text-[10px] uppercase font-bold text-muted-foreground",children:"All"}),e.jsx(r,{variant:"ghost",size:"sm",className:"text-[10px] uppercase font-bold text-muted-foreground",children:"Prod"}),e.jsx(r,{variant:"ghost",size:"sm",className:"text-[10px] uppercase font-bold text-muted-foreground",children:"Sandbox"})]})]}),e.jsx(x,{children:e.jsx(oe,{keys:t?.keys||[]})})]}),e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(o,{className:"text-lg font-bold",children:"Execution & Access Trace"})}),e.jsx(x,{children:e.jsx(je,{logs:t?.logs||[]})})]})]}),e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsx(me,{scopes:t?.scopes||[]}),e.jsx(ue,{}),e.jsx(he,{data:t?.usageTrend||[]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-yellow-500/5 border-yellow-500/20 flex flex-col items-center text-center space-y-2",children:[e.jsx(p,{className:"h-8 w-8 text-yellow-500"}),e.jsx("p",{className:"text-[11px] font-bold",children:"Enterprise Security Standard"}),e.jsx("p",{className:"text-[10px] text-muted-foreground leading-relaxed",children:"Automated rotation is enforced for all Production environment keys every 90 days."})]})]})]})]})}export{Oe as default};
