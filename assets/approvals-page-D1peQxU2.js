import{e as I,j as e,p as A,T as P,f as G,g as H,h as M,B as n}from"./index-CyvJUZqR.js";import{u as B}from"./use-approvals-data-4mP0RNKv.js";import{C as x,a as p,b as m,c as h}from"./card-9e5eR-TL.js";import{C as f}from"./clock-BXrF9XKR.js";import{C as T}from"./circle-check-LM3MRdPF.js";import{T as g}from"./triangle-alert-BFLjuX3_.js";import{T as O,a as $,b,c as o,d as U,e as d}from"./table-DPilA-Lh.js";import{s as z}from"./seniorDevelopersData-DFrZ6X3t.js";import{C}from"./circle-alert-BykDmaaL.js";import{R as N,T as v}from"./CategoricalChart-WJAmy3lP.js";import{P as Q,a as K}from"./PieChart-CsfmQ4gU.js";import{C as E}from"./tooltipContext-BhFxnOuu.js";import{L as V}from"./Legend-121kkJQm.js";import{B as D,a as S}from"./BarChart-gLJDjHRP.js";import{C as R}from"./CartesianGrid-BmRwr4Ov.js";import{X as k,Y as L}from"./CartesianChart-Kxs-tJ8o.js";import{A as W}from"./arrow-right-BNY497oc.js";import{M as _}from"./message-square-CpLMVWv4.js";import{S as J}from"./send-DPrubeqO.js";import"./useQuery-DOA-4dB4.js";import"./ActiveShapeUtils-tTCqnt4A.js";import"./PolarChart-D353rnxE.js";import"./ErrorBarContext-BO_Rq41O.js";import"./graphicalItemSelectors-01I7ku9s.js";const q=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],X=I("clipboard-list",q);function Y({metrics:t}){const i=[{title:"Total Requests",value:t.totalRequests,icon:X,color:"text-blue-600",description:"Governance control gate"},{title:"Pending Approvals",value:t.pendingApprovals,icon:f,color:"text-yellow-600",description:"Awaiting authority sign-off"},{title:"Approved Today",value:t.approvedToday,icon:T,color:"text-green-600",description:"Executed gatekeeper decisions"},{title:"Escalations",value:t.escalations,icon:g,color:"text-red-600",description:"Critical technical blockers"}];return e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:i.map(r=>e.jsxs(x,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:r.title}),e.jsx(r.icon,{className:`h-4 w-4 ${r.color}`})]}),e.jsxs(h,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.value}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.description})]})]},r.title))})}function F({requests:t,slas:i}){const r=A(),c=a=>{switch(a){case"APPROVED":return e.jsx(n,{className:"bg-green-100 text-green-800 border-green-200",children:"APPROVED"});case"PENDING":return e.jsx(n,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"PENDING"});case"REJECTED":return e.jsx(n,{className:"bg-red-100 text-red-800 border-red-200",children:"REJECTED"});case"ESCALATED":return e.jsx(n,{className:"bg-purple-100 text-purple-800 border-purple-200",children:"ESCALATED"})}},s=a=>{switch(a){case"HIGH":return e.jsx(n,{variant:"destructive",children:"HIGH"});case"MEDIUM":return e.jsx(n,{variant:"secondary",className:"bg-orange-100 text-orange-800",children:"MEDIUM"});case"LOW":return e.jsx(n,{variant:"outline",children:"LOW"})}},l=a=>z.find(u=>u.id===a)?.name||a,j=a=>i.find(u=>u.approvalId===a)?.breached||!1;return e.jsxs(x,{className:"col-span-full",children:[e.jsx(p,{children:e.jsx(m,{children:"Approval Governance Queue"})}),e.jsx(h,{children:e.jsx(P,{children:e.jsxs(O,{children:[e.jsx($,{children:e.jsxs(b,{children:[e.jsx(o,{children:"Request Title"}),e.jsx(o,{children:"Type"}),e.jsx(o,{children:"Project"}),e.jsx(o,{children:"Assigned To"}),e.jsx(o,{children:"Priority"}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"Created At"}),e.jsx(o,{className:"text-right",children:"Action"})]})}),e.jsx(U,{children:t.map(a=>e.jsxs(b,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>r(`/governance/approvals/${a.id}`),children:[e.jsx(d,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.title,j(a.id)&&e.jsxs(G,{children:[e.jsx(H,{asChild:!0,children:e.jsx(C,{className:"h-4 w-4 text-red-500"})}),e.jsx(M,{children:e.jsx("p",{children:"SLA Breached"})})]})]})}),e.jsx(d,{children:e.jsx(n,{variant:"outline",className:"text-[10px]",children:a.type})}),e.jsx(d,{children:a.projectId}),e.jsx(d,{className:"text-sm",children:l(a.assignedTo)}),e.jsx(d,{children:s(a.priority)}),e.jsx(d,{children:c(a.status)}),e.jsx(d,{className:"text-xs text-muted-foreground",children:new Date(a.createdAt).toLocaleDateString()}),e.jsx(d,{className:"text-right",children:e.jsx("span",{className:"text-xs text-primary font-medium",children:"Review →"})})]},a.id))})]})})})]})}const y=["#16a34a","#d97706","#dc2626","#9333ea"];function Z({data:t}){return e.jsxs(x,{className:"col-span-1",children:[e.jsx(p,{children:e.jsx(m,{children:"Decision Status Distribution"})}),e.jsx(h,{children:e.jsx("div",{className:"h-[250px] w-full",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(Q,{children:[e.jsx(K,{data:t,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:t.map((i,r)=>e.jsx(E,{fill:y[r%y.length]},`cell-${r}`))}),e.jsx(v,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(V,{verticalAlign:"bottom",height:36})]})})})})]})}const w=["#2563eb","#10b981","#f59e0b","#ef4444","#8b5cf6"];function ee({data:t}){return e.jsxs(x,{className:"col-span-1",children:[e.jsx(p,{children:e.jsx(m,{children:"Approval Type Distribution"})}),e.jsx(h,{children:e.jsx("div",{className:"h-[250px] w-full",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(D,{data:t,children:[e.jsx(R,{strokeDasharray:"3 3",vertical:!1}),e.jsx(k,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fontSize:10}}),e.jsx(L,{axisLine:!1,tickLine:!1,tick:{fontSize:10}}),e.jsx(v,{cursor:{fill:"transparent"},contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(S,{dataKey:"value",radius:[4,4,0,0],children:t.map((i,r)=>e.jsx(E,{fill:w[r%w.length]},`cell-${r}`))})]})})})})]})}function se({requests:t,slas:i}){const r=A(),c=t.filter(s=>s.status==="PENDING").filter(s=>{const l=i.find(j=>j.approvalId===s.id);return s.priority==="HIGH"||l?.breached}).slice(0,5);return e.jsxs(x,{className:"col-span-1",children:[e.jsx(p,{children:e.jsxs(m,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(C,{className:"h-5 w-5"}),"Urgent Approval Queue"]})}),e.jsx(h,{className:"space-y-4",children:c.length>0?c.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>r(`/governance/approvals/${s.id}`),children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none truncate max-w-[200px]",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-muted-foreground",children:[e.jsx(n,{variant:"outline",className:"h-4 py-0 text-[8px]",children:s.type}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(f,{className:"h-3 w-3"}),new Date(s.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[s.priority==="HIGH"&&e.jsx(n,{variant:"destructive",className:"h-5 py-0 text-[9px]",children:"URGENT"}),e.jsx(W,{className:"h-4 w-4 text-muted-foreground"})]})]},s.id)):e.jsx("p",{className:"text-center text-sm text-muted-foreground py-4",children:"No urgent items pending."})})]})}function te({data:t}){return e.jsxs(x,{className:"col-span-1",children:[e.jsx(p,{children:e.jsx(m,{children:"Approver Decision Load"})}),e.jsx(h,{children:e.jsx("div",{className:"h-[250px] w-full",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(D,{data:t,layout:"vertical",margin:{left:20},children:[e.jsx(R,{strokeDasharray:"3 3",horizontal:!1}),e.jsx(k,{type:"number",hide:!0}),e.jsx(L,{dataKey:"name",type:"category",axisLine:!1,tickLine:!1,tick:{fontSize:10},width:80}),e.jsx(v,{cursor:{fill:"transparent"},contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(S,{dataKey:"approvals",fill:"#3b82f6",radius:[0,4,4,0],barSize:20})]})})})})]})}function re({requests:t,decisions:i}){const r=[...t.map(s=>({id:`req-${s.id}`,type:"REQUEST",title:`Approval Requested: ${s.title}`,timestamp:s.createdAt,status:s.status,user:s.requestedBy,requestType:s.type})),...i.map(s=>({id:`dec-${s.id}`,type:"DECISION",title:`Decision Rendered: ${s.decision}`,timestamp:s.timestamp,comment:s.comment,user:s.approverId,status:s.decision}))].sort((s,l)=>new Date(l.timestamp).getTime()-new Date(s.timestamp).getTime()),c=(s,l)=>s==="REQUEST"?e.jsx(J,{className:"h-4 w-4 text-blue-500"}):l==="APPROVED"?e.jsx(T,{className:"h-4 w-4 text-green-500"}):l==="REJECTED"?e.jsx(g,{className:"h-4 w-4 text-red-500"}):l==="ESCALATED"?e.jsx(g,{className:"h-4 w-4 text-purple-500"}):e.jsx(f,{className:"h-4 w-4 text-yellow-500"});return e.jsxs(x,{className:"col-span-full",children:[e.jsx(p,{children:e.jsx(m,{children:"Governance Audit Timeline"})}),e.jsx(h,{children:e.jsx("div",{className:"space-y-6",children:r.map(s=>e.jsxs("div",{className:"relative pl-8 before:absolute before:left-[15px] before:top-2 before:bottom-[-24px] before:w-[2px] before:bg-muted last:before:hidden",children:[e.jsx("div",{className:"absolute left-0 top-1 rounded-full border bg-background p-1.5 z-10",children:c(s.type,s.status)}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold",children:s.title}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:new Date(s.timestamp).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["User: ",e.jsx("span",{className:"text-foreground",children:s.user})]}),s.type==="REQUEST"&&s.requestType&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx(n,{variant:"outline",className:"text-[8px] h-4",children:s.requestType})]})]}),s.type==="DECISION"&&s.comment&&e.jsxs("div",{className:"mt-2 flex gap-2 items-start bg-muted/30 p-2 rounded text-xs italic",children:[e.jsx(_,{className:"h-3 w-3 mt-0.5 opacity-50"}),e.jsx("p",{children:s.comment})]})]})]},s.id))})})]})}function De(){const{requests:t,decisions:i,slas:r,metrics:c,statusDistribution:s,typeDistribution:l,approverWorkload:j,isLoading:a}=B();return a?e.jsx("div",{children:"Loading Governance Control Gates..."}):e.jsxs("div",{className:"flex flex-col gap-6 p-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Approval Governance"}),e.jsx("p",{className:"text-muted-foreground",children:"Execution gatekeeper and authority control layer."})]}),e.jsx(Y,{metrics:c}),e.jsx(F,{requests:t||[],slas:r||[]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsx(Z,{data:s}),e.jsx(ee,{data:l})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsx(se,{requests:t||[],slas:r||[]}),e.jsx(te,{data:j})]}),e.jsx(re,{requests:t||[],decisions:i||[]})]})}export{De as default};
