import{e as w,j as e,c as T,i as h,r as S,O as k,l as C}from"./index-CyvJUZqR.js";import{u as L}from"./useQuery-DOA-4dB4.js";import{T as D,a as E,b as u,c,d as I,e as n}from"./table-DPilA-Lh.js";import{T as b}from"./terminal-Ds5tqkxs.js";import{E as R}from"./external-link-CjI-hOui.js";import{I as O}from"./input-8HBaoNJU.js";import{S as j,a as f,b as g,c as N,d as t}from"./select-DMU1Mhcj.js";import{S as A}from"./search-CyLX92Us.js";import{T as M}from"./trash-2-GPajQJ1z.js";import{T as F,a as H,b as d}from"./tabs-D3p3EBKe.js";import{C as o,a as x,b as m,c as p}from"./card-9e5eR-TL.js";import{C as P}from"./circle-alert-BykDmaaL.js";import{C as z}from"./copy-BhE0TJ9y.js";import{D as G,a as W,b as q,c as V,d as Z}from"./dialog-CXSb95VD.js";import{S as B}from"./separator-DrhA6iK3.js";import{D as v}from"./database-BCwPF7Xr.js";import{T as X}from"./tag-ccO6Al_e.js";import{T as U}from"./triangle-alert-BFLjuX3_.js";import"./index-p66pR0EO.js";import"./chevron-down-DT8imn2m.js";const K=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],_=w("sliders-horizontal",K),J=[{id:"LOG-001",source:"Deployment Service",referenceId:"DEP-001",level:"ERROR",message:"Container failed to start: health check timeout",timestamp:"2026-02-14T08:32:00Z",resolved:!1,stackTrace:`Error: Health check failed after 30s
  at checkHealth (deploy-service/src/health.ts:12:5)
  at async deploy (deploy-service/src/index.ts:45:2)`},{id:"LOG-002",source:"Frontend Agent",referenceId:"A-001",level:"INFO",message:"Started landing page optimization task",timestamp:"2026-02-14T14:15:00Z",metadata:{taskId:"TASK-456",duration:"120ms"}},{id:"LOG-003",source:"CI/CD Pipeline",referenceId:"PIPE-088",level:"WARN",message:"Dependency 'lodash' has known security vulnerability (CVE-2024-XXXX)",timestamp:"2026-02-14T14:20:00Z",metadata:{package:"lodash",version:"4.17.21"}},{id:"LOG-004",source:"Agent Orchestrator",referenceId:"ORCH-99",level:"DEBUG",message:"Rebalancing agent loads across cluster 'us-east-1'",timestamp:"2026-02-14T14:25:00Z"},{id:"LOG-005",source:"Workflow Engine",referenceId:"WF-101",level:"INFO",message:"Workflow 'Main CI Pipeline' triggered by commit 'abc1234'",timestamp:"2026-02-14T14:15:10Z"},{id:"LOG-006",source:"Backend Agent",referenceId:"A-002",level:"ERROR",message:"Failed to connect to database: Connection refused",timestamp:"2026-02-14T14:28:30Z",resolved:!1,stackTrace:`MongoNetworkError: connect ECONNREFUSED 127.0.0.1:27017
  at connectionFailure (mongodb/lib/core/connection.js:123:10)`}],Q={totalLogs:12540,errorCount:42,warningCount:128,volumeTrend:"+5% vs yesterday"};function Y(){return L({queryKey:["logs-data"],queryFn:async()=>(await new Promise(s=>setTimeout(s,500)),{logs:J,stats:Q})})}function $({logs:s,onSelectLog:i}){const r=a=>{switch(a){case"ERROR":return"text-red-500 bg-red-500/10 border-red-500/20";case"WARN":return"text-yellow-500 bg-yellow-500/10 border-yellow-500/20";case"DEBUG":return"text-blue-500 bg-blue-500/10 border-blue-500/20";default:return"text-slate-400 bg-slate-400/10 border-slate-400/20"}};return e.jsxs("div",{className:"rounded-md border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-2 p-3 border-b bg-muted/30",children:[e.jsx(b,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-semibold",children:"Live Log Stream"})]}),e.jsxs(D,{children:[e.jsx(E,{className:"bg-muted/50",children:e.jsxs(u,{children:[e.jsx(c,{className:"w-[180px]",children:"Timestamp"}),e.jsx(c,{className:"w-[80px]",children:"Level"}),e.jsx(c,{className:"w-[150px]",children:"Source"}),e.jsx(c,{children:"Message"}),e.jsx(c,{className:"w-[120px]",children:"Ref ID"}),e.jsx(c,{className:"w-[50px]"})]})}),e.jsx(I,{className:"font-mono text-[12px]",children:s.map(a=>e.jsxs(u,{className:"hover:bg-muted/50 cursor-pointer group",onClick:()=>i(a),children:[e.jsx(n,{className:"text-muted-foreground whitespace-nowrap",children:new Date(a.timestamp).toLocaleString()}),e.jsx(n,{children:e.jsx("span",{className:T("px-1.5 py-0.5 rounded border text-[10px] font-bold",r(a.level)),children:a.level})}),e.jsx(n,{className:"font-medium",children:a.source}),e.jsx(n,{className:"max-w-[400px] truncate",children:a.message}),e.jsx(n,{className:"text-muted-foreground font-mono",children:a.referenceId}),e.jsx(n,{children:e.jsx(R,{className:"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity"})})]},a.id))})]})]})}function ee(){return e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(O,{placeholder:"Search logs (message, reference ID, metadata)...",className:"pl-9 h-9"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{defaultValue:"all",children:[e.jsx(f,{className:"w-[120px] h-9",children:e.jsx(g,{placeholder:"Level"})}),e.jsxs(N,{children:[e.jsx(t,{value:"all",children:"All Levels"}),e.jsx(t,{value:"info",children:"Info"}),e.jsx(t,{value:"warn",children:"Warning"}),e.jsx(t,{value:"error",children:"Error"}),e.jsx(t,{value:"debug",children:"Debug"})]})]}),e.jsxs(j,{defaultValue:"all",children:[e.jsx(f,{className:"w-[150px] h-9",children:e.jsx(g,{placeholder:"Source"})}),e.jsxs(N,{children:[e.jsx(t,{value:"all",children:"All Sources"}),e.jsx(t,{value:"deployment",children:"Deployment Service"}),e.jsx(t,{value:"agent",children:"Agent Orchestrator"}),e.jsx(t,{value:"pipeline",children:"CI/CD Pipeline"})]})]}),e.jsxs(h,{variant:"outline",size:"sm",className:"h-9",children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"More Filters"]}),e.jsx(h,{variant:"ghost",size:"sm",className:"h-9 text-red-500 hover:text-red-600",children:e.jsx(M,{className:"h-4 w-4"})})]})]})}function se(){return e.jsx(F,{defaultValue:"all",className:"w-full",children:e.jsxs(H,{className:"w-full justify-start h-auto p-1 bg-muted/50 overflow-x-auto",children:[e.jsx(d,{value:"all",className:"text-xs py-1.5 px-3",children:"All Logs"}),e.jsx(d,{value:"deployments",className:"text-xs py-1.5 px-3",children:"Deployments"}),e.jsx(d,{value:"agents",className:"text-xs py-1.5 px-3",children:"Agents"}),e.jsx(d,{value:"pipelines",className:"text-xs py-1.5 px-3",children:"Pipelines"}),e.jsx(d,{value:"workflows",className:"text-xs py-1.5 px-3",children:"Workflows"}),e.jsx(d,{value:"errors",className:"text-xs py-1.5 px-3 text-red-500 data-[state=active]:text-red-500",children:"Errors"})]})})}function ae({error:s}){return!s||s.level!=="ERROR"?null:e.jsxs(o,{className:"border-red-500/20 bg-red-500/[0.02]",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between py-3",children:[e.jsxs(m,{className:"text-sm font-bold flex items-center gap-2 text-red-500",children:[e.jsx(P,{className:"h-4 w-4"}),"Error Trace: ",s.id]}),e.jsx(h,{variant:"outline",size:"icon",className:"h-7 w-7",children:e.jsx(z,{className:"h-3 w-3"})})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold mb-1",children:"Message"}),e.jsx("p",{className:"text-xs text-red-600 bg-red-500/10 p-2 rounded border border-red-500/20 font-mono",children:s.message})]}),s.stackTrace&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold mb-1",children:"Stack Trace"}),e.jsx("pre",{className:"text-[11px] p-3 rounded bg-slate-950 text-slate-300 overflow-x-auto font-mono leading-relaxed",children:s.stackTrace})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-muted-foreground uppercase font-bold",children:"Source"}),e.jsx("p",{className:"text-xs",children:s.source})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-muted-foreground uppercase font-bold",children:"Reference"}),e.jsx("p",{className:"text-xs font-mono",children:s.referenceId})]})]})]})]})}function te({log:s,isOpen:i,onClose:r}){return s?e.jsx(G,{open:i,onOpenChange:r,children:e.jsxs(W,{className:"max-w-2xl font-mono",children:[e.jsxs(q,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-1.5 rounded bg-muted",children:e.jsx(b,{className:"h-4 w-4"})}),e.jsxs(V,{className:"text-sm",children:["Log Details: ",s.id]})]}),e.jsxs(Z,{className:"text-xs",children:["Captured at ",new Date(s.timestamp).toISOString()]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(v,{className:"h-3 w-3"})," Source"]}),e.jsx("p",{className:"font-semibold",children:s.source})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(X,{className:"h-3 w-3"})," Reference ID"]}),e.jsx("p",{className:"font-semibold",children:s.referenceId})]})]}),e.jsx(B,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Message"}),e.jsx("div",{className:"p-3 rounded bg-muted/50 border text-xs leading-relaxed",children:s.message})]}),s.metadata&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Metadata"}),e.jsx("pre",{className:"p-3 rounded bg-slate-950 text-slate-300 text-[11px] overflow-auto",children:JSON.stringify(s.metadata,null,2)})]}),s.stackTrace&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground text-red-500",children:"Stack Trace"}),e.jsx("pre",{className:"p-3 rounded bg-slate-950 text-red-400 text-[11px] overflow-auto border border-red-900/50",children:s.stackTrace})]})]})]})}):null}function Te(){const{data:s,isLoading:i}=Y(),[r,a]=S.useState(null);if(i)return e.jsx("div",{className:"flex items-center justify-center h-full text-sm font-mono",children:"Streaming logs..."});const y=s?.logs.filter(l=>l.level==="ERROR")||[];return e.jsxs("div",{className:"flex-1 space-y-4 p-4 pt-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-3xl font-bold tracking-tight text-foreground",children:"Centralized Logs"})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(o,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-[10px] font-bold uppercase tracking-wider text-muted-foreground",children:"Total Logs (24h)"}),e.jsx(v,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s?.stats.totalLogs.toLocaleString()}),e.jsx("p",{className:"text-[10px] text-green-500 font-medium",children:s?.stats.volumeTrend})]})]}),e.jsxs(o,{className:"border-red-500/20",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-[10px] font-bold uppercase tracking-wider text-red-500",children:"Critical Errors"}),e.jsx(U,{className:"h-4 w-4 text-red-500"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:s?.stats.errorCount}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Across all services"})]})]}),e.jsxs(o,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-[10px] font-bold uppercase tracking-wider text-yellow-500",children:"System Warnings"}),e.jsx(C,{className:"h-4 w-4 text-yellow-500"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s?.stats.warningCount}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Investigate traces"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(se,{}),e.jsx(ee,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx($,{logs:s?.logs||[],onSelectLog:a})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(ae,{error:r}),e.jsxs(o,{children:[e.jsx(x,{children:e.jsx(m,{className:"text-sm",children:"Recent Errors"})}),e.jsx(p,{className:"space-y-3",children:y.map(l=>e.jsxs("div",{className:"p-2 rounded border border-red-500/10 bg-red-500/5 cursor-pointer hover:bg-red-500/10 transition-colors",onClick:()=>a(l),children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"text-[10px] font-bold text-red-600",children:l.source}),e.jsx("span",{className:"text-[9px] text-muted-foreground",children:new Date(l.timestamp).toLocaleTimeString()})]}),e.jsx("p",{className:"text-[11px] font-mono line-clamp-2",children:l.message})]},l.id))})]})]})]})]}),e.jsx(te,{log:r,isOpen:!!r,onClose:()=>a(null)})]})}export{Te as default};
